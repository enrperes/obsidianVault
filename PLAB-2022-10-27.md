La procedura frase si applica a tre argomenti di tipo stringa che svolgono rispettivamente i ruoli di soggetto,
predicato verbale e complemento oggetto. Soggetto e complemento oggetto sono rappresentati da sostantivi della
lingua italiana; il predicato verbale dall'infinito di un verbo. La procedura restituisce una stringa che rappresenta una
frase compiuta in italiano, dove i sostantivi son preceduti da articoli determinativi appropriati e il verbo è declinato
correttamente, come negli esempi riportati sotto. Per semplicità, considera solo sostantivi maschili che terminano con la
lettera
"g" al singolare, con la
"i'" al plurale e che possano essere preceduti dagli articoli "il" o "¡'; considera solo
sostantivi femminili che terminano con la lettera "a" al singolare, con la "e" al plurale e che possano essere preceduti
dagli articoli "la" o "le"; considera inoltre solo verbi che, declinati alla terza persona dell'indicativo presente, hanno un
comportamento regolare (-are
›-a/-ano, -ere -›-e/-ono, -ire
-e/-ono).
Definisci la procedura frase in Scheme. Cerca di organizzare il programma introducendo opportune procedure di
supporto che risolvono sottoproblemi specifici semplici, privilegiando la chiarezza (leggibilità) del codice.



---

````scheme
(define are?

  (lambda (v)

    (char=? (string-ref v (- (string-length v) 3)) #\a )

    )

  )

  

(define IIIpers

  (lambda (verbo)

    (if (are? verbo)

        (string-append (substring verbo 0 (- (string-length verbo) 3)) "a ")

        (string-append (substring verbo 0 (- (string-length verbo) 3)) "e ")

    )

  )

 )

  

(define IIIperp

  (lambda (verbo)

    (if (are? verbo)

        (string-append (substring verbo 0 (- (string-length verbo) 3)) "ano ")

        (string-append (substring verbo 0 (- (string-length verbo) 3)) "ono ")

    )

  )

 )

  

(define singolare?

  (lambda (s)

    (or

     (char=? (string-ref s (- (string-length s) 1)) #\o)

     (char=? (string-ref s (- (string-length s) 1)) #\a)

    )

  )

 )

  

(define IIIpersona

  (lambda (p v)

    (if (singolare? p)

        (IIIpers v)

        (IIIperp v)

        )

    ))

  

(define maschile?

  (lambda (p)

      (or

         (char=? (string-ref p (- (string-length p) 1)) #\o)

         (char=? (string-ref p (- (string-length p) 1)) #\i)

    )

    )

  )

  

(define arts

  (lambda (art)

    (if (maschile? art)

        (string-append "il " art " ")

        (string-append "la " art " ")

    )

  )

 )

  

(define artp

  (lambda (art)

    (if (maschile? art)

        (string-append "i " art " ")

        (string-append "le " art " ")

    )

  )

 )

  

(define articolo

  (lambda (p)

    (if (singolare? p)

        (arts p)

        (artp p)

        )

    ))

  

(define frase

  (lambda (p1 p2 p3)

    (string-append (articolo p1) (IIIpersona  p1 p2) (articolo p3))))
```